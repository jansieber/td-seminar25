function f=sd_rhs(x,p)
%% Right-hand side of sd_demo (vectorized in x(1:5,1:7,:) and p(1,1:11,:))
f=NaN(size(x,1),size(x,3));
f(1,:)=(1./(p(1,1,:)+x(2,1,:))).*(1-p(1,2,:).*x(1,1,:).*x(1,4,:).*x(3,4,:)+...
    p(1,3,:).*x(1,2,:).*x(2,3,:));
f(2,:)=p(1,4,:).*x(1,1,:)./(p(1,1,:)+x(2,1,:))+p(1,5,:).*tanh(x(2,6,:))-1;
f(3,:)=p(1,6,:).*(x(2,1,:)-x(3,1,:))-p(1,7,:).*(x(1,7,:)-...
    x(2,5,:)).*exp(-p(1,8,:).*x(4,1,:));
f(4,:)=x(1,5,:).*exp(-p(1,1,:)*x(4,1,:))-0.1;
f(5,:)=3*(x(1,3,:)-x(5,1,:))-p(1,9,:); 
end
